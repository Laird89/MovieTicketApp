var cities = [
  {
    name: "Toronto",
    theaters: [
      {
        name: "Cineplex Cinemas Beaches",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["5:00 PM", "6:30 PM", "9:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
      {
        name: "Cineplex VIP Don Mills",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
      {
        name: "Scotiabank Theatre",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
    ],
  },
  {
    name: "Oakville",
    theaters: [
      {
        name: "Cineplex Oakville VIP",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
      {
        name: "Cineplex Winston Churchill",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
      {
        name: "Film.ca Cinemas",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
    ],
  },
  {
    name: "Mississauga",
    theaters: [
      {
        name: "Cineplex Cinemas Mississauga",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
      {
        name: "Cineplex Junxion Erin Mills",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
      {
        name: "Cineplex Cinemas Courtney Park",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
    ],
  },
  {
    name: "Burlington",
    theaters: [
      {
        name: "Cine Starz",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
      {
        name: "Silvercity Burlington",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
      {
        name: "Cineplex Cinemas VIP",
        movies: [
          {
            title: "A Haunting in Venice",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "After Everything",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Nun 2",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "My Big Fat Greek Wedding 3",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Barbie",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Oppenheimer",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "The Equalizer 3",
            showtimes: ["10:00 AM", "1:00 PM", "4:00 PM"],
          },
          {
            title: "Gran Turismo: Based On a True Story",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
          {
            title: "Mission: Impossible Dead Reckoning - Part 1",
            showtimes: ["11:00 AM", "2:00 PM", "5:00 PM"],
          },
        ],
      },
    ],
  },
];

const ticketPrice = 18.0;

function updatePage() {
  let header = document.getElementById("header");
  let footer = document.getElementById("footer");

  header.innerHTML = `<p class="header">Fall 2023 Assignment #1 for Chris Laird from Canada</p>`;
  footer.innerHTML = `<p class="footer">My Login: lairdch / My ID: 991279847 / My Program: Computer Programming</p>`;

  createList();
}

function createList() {
  var selectCity = document.getElementById("city");
  selectCity.innerHTML = "<option value='0'>Select a City</option>";

  for (let city of cities) {
    selectCity.innerHTML += `<option>${city.name}</option>`;
  }

  var selectMovie = document.getElementById("movies");
  selectMovie.innerHTML = "<option value='0'>Select a Movie</option>";

  var selectShowtime = document.getElementById("showtimes");
  selectShowtime.innerHTML = "<option value='0'>Select a Showtime</option>";
}

function setLocations() {
  var selectCity = document.getElementById("city");
  var selectedCity = selectCity.value;
  var locations = document.getElementById("location");

  var cityData = {
    Toronto: cities[0].theaters,
    Oakville: cities[1].theaters,
    Mississauga: cities[2].theaters,
    Burlington: cities[3].theaters,
  };

  if (selectedCity === "0") {
    locations.style.display = "none";
  } else {
    locations.style.display = "block";

    var theaters = cityData[selectedCity];

    var html = "";
    for (var theater of theaters) {
      html += `
          <input type="radio" onchange="getMovies()" class="location-radio" name="location" value="${theater.name}">
          <label>${theater.name}</label>
        `;
    }

    locations.innerHTML = html;
  }
}

function getMovies() {
  var selectedLocation = document.querySelector(
    'input[name="location"]:checked'
  );
  var movieSelect = document.getElementById("movies");
  var showtimeSelect = document.getElementById("showtimes");
  if (selectedLocation) {
    var locationValue = selectedLocation.value;

    var selectedTheater;
    var selectedCity;
    for (let city of cities) {
      for (let theater of city.theaters) {
        if (theater.name === locationValue) {
          selectedTheater = theater;
          selectedCity = city;
          break;
        }
      }
      if (selectedTheater) {
        break;
      }
    }

    if (selectedTheater) {
      movieSelect.innerHTML = "<option value='0'>Select a Movie</option>";
      showtimeSelect.innerHTML = "<option value='0'>Select a Showtime</option>";

      for (let movie of selectedTheater.movies) {
        movieSelect.innerHTML += `<option>${movie.title}</option>`;
      }
    }
  }

  movieSelect.addEventListener("change", function () {
    var selectedMovie = movieSelect.value;

    showtimeSelect.innerHTML = "<option value='0'>Select a Showtime</option>";

    for (let movie of selectedTheater.movies) {
      if (movie.title === selectedMovie) {
        for (let showtime of movie.showtimes) {
          showtimeSelect.innerHTML += `<option>${showtime}</option>`;
        }
        break;
      }
    }
  });
}

function ageCheck() {
  let ageInput = document.getElementById("age");

  if (ageInput.value < 20) {
    ageInput.style.borderColor = "red";
    ageInput.style.backgroundColor = "#fbdada";
  } else {
    ageInput.style.borderColor = "black";
    ageInput.style.backgroundColor = "white";
  }
}

function updateTotalPrice() {
  let ticketInput = document.getElementById("tickets");
  let ticketAmount = document.getElementById("tickets").value;
  let cost = ticketAmount * ticketPrice;
  let total = document.getElementById("total");

  if (ticketAmount < 0) {
    ticketInput.style.borderColor = "red";
    ticketInput.style.backgroundColor = "#fbdada";
  } else {
    ticketInput.style.borderColor = "black";
    ticketInput.style.backgroundColor = "white";
    total.innerHTML = `$${cost}`;
  }
}

function showPurchaseSummary(event) {
  event.preventDefault();
  let age = document.getElementById("age").value;
  let ticketAmount = document.getElementById("tickets").value;
  var selectedCity = document.getElementById("city").value;
  var selectedLocation = document.querySelector(
    'input[name="location"]:checked'
  );
  var selectedShowtime = document.getElementById("showtimes").value;

  if (age < 20 && ticketAmount < 0) {
    alert(
      "Age must be 20 or above and there must be at least 1 ticket purchased to purchase tickets."
    );
  } else if (ticketAmount < 0) {
    alert("Must purchase at least 1 ticket");
  } else if (age < 20) {
    alert("Age must be 20 or above to purchase ticket");
  } else if (selectedCity === "0") {
    alert("Please select a city.");
  } else if (!selectedLocation) {
    alert("Please select a theater location.");
  } else if (selectedShowtime === "0") {
    alert("Please select a showtime.");
  } else {
    saveDataToLS();
    location.assign("./pages/purchaseSummary.html");
  }
}

function saveDataToLS() {
  let city = document.getElementById("city").value;
  let location = document.querySelector('input[name="location"]:checked').value;
  let movie = document.getElementById("movies").value;
  let date = document.getElementById("date").value;
  let ticketAmount = document.getElementById("tickets").value;
  let showtime = document.getElementById("showtimes").value;
  let firstName = document.getElementById("firstName").value;
  let lastName = document.getElementById("lastName").value;
  let email = document.getElementById("email").value;
  let gender = document.getElementById("gender").value;
  let age = document.getElementById("age").value;
  let totalCost = document.getElementById("tickets").value * ticketPrice;

  localStorage.setItem("city", city);
  localStorage.setItem("location", location);
  localStorage.setItem("movie", movie);
  localStorage.setItem("date", date);
  localStorage.setItem("ticketAmount", ticketAmount);
  localStorage.setItem("showtime", showtime);
  localStorage.setItem("firstName", firstName);
  localStorage.setItem("lastName", lastName);
  localStorage.setItem("email", email);
  localStorage.setItem("gender", gender);
  localStorage.setItem("age", age);
  localStorage.setItem("totalCost", totalCost);
}
